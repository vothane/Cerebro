(ns cerebro.HiddenLayer.HLayer_test
  (:require [clojure.test :refer :all]
            [cerebro.HiddenLayer.HLayer :refer :all]))

(deftest hidden-layer-test
  (testing "hidden layer"
    (let [hl {:W [[0.14142958607095213 -0.09266647551292541 0.0772905918794082 -0.14099685447053134 -0.05349333511775113 -0.09567588113501038] 
                  [-0.11125978685596784 0.04268112877616282 0.15627993581732436 -0.10238492086070262 -0.0792493993065675 0.10793664553091545] 
                  [0.10951416049204235 -0.08316652554536971 0.0632393076839947 -0.07325757153283004 0.08309947084948825 -0.18587906751489314]] 
              :bias [0.016781592856728436 -0.01693279279285234 -0.0002514603557369245]} 
          sample (hidden-sample-h|v hl [1 1 1 0 0 0])]
      (is (= 3 (count sample)))
      (is (every? #{0 1} sample)))))
